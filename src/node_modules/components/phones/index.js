import React,{useEffect} from 'react'
import {compose} from "redux";
import {connect} from "react-redux";
import {FetchPhones, loadMorePhones} from "actions";
import {getPhones} from "selectors";
import * as R from 'ramda'
import {Link} from "react-router-dom";
import Layout from 'components/layout'
let Phones = (props) => {
    useEffect(() => props.FetchPhones(), [])
    console.log(props.phones)
    let renderPhone = (phone, index) => {
        const shortDescription = `${R.take(60, phone.description)}`
        return (
            <div className='col-sm-4 col-lg-4 col-md-4 book-list' key={index}>
                <div className='thumbnail'>
                    <img className='img-thumbnail'
                         src={phone.image}
                         alt={phone.name}/>
                    <div className='caption'>
                        <h4 className='pull-right'>${phone.price}</h4>
                        <h4><Link to={`/phones/${phone.id}`}>
                            {phone.name}
                        </Link></h4>
                        <p>{shortDescription}</p>
                        <p className='item-button'>
                            <button className='btn btn-primary'>
                                Buy Now
                            </button>
                            <Link to={`/phones/${phone.id}`} classname='btn btn-default'>More info</Link>
                        </p>
                    </div>
                </div>
            </div>
        )
    }

    return (
        <Layout>
        <div>
            <div className='books row'>{
                props.phones.map((phones, index) => renderPhone(phones, index))
            }</div>
            <div className="row">
                <div className="col-md-12">
                    <button onClick={props.loadMorePhones}
                            className='pull-right btn btn-primary'>
                        Load More
                    </button>
                </div>
            </div>
        </div>
        </Layout>
    )
}
let mapDispatchToProps = {
    FetchPhones,
    loadMorePhones
}
let mapStateToProps = (state) => ({
    phones : getPhones(state)
})
export default  connect(mapStateToProps,mapDispatchToProps)(Phones)